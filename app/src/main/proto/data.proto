syntax = "proto3";
package net.ixitxachitls.companion.proto;

import "value.proto";
import "entity.proto";

message SettingsProto {
  string nickname = 1;
  string app_id = 2;
  bool show_status = 3;
}

message CampaignProto {
  string name = 1;
  string world = 2;
  bool remote = 3;
  string id = 4;
  string dm = 5;
  bool published = 6;

  message Date {
    int32 year = 1;
    int32 month = 2;
    int32 day = 3;
    int32 hour = 4;
    int32 minute = 5;
  }
  Date date = 7;

  message Battle {
    BattleStatus status = 1;
    int32 turn = 2;
    repeated string initiative_order = 3;

    message Combatant {
      string name = 1;
      int32 initiative_modifier = 2;
      bool monster = 3;
      bool waiting = 4;
    }
    repeated Combatant combatant = 4;
    int32 current_combatant_index = 5;
  }
  Battle battle = 8;
}

message CharacterProto {
  string id = 1;
  string name = 2;
  string race = 3;
  Gender gender = 4;

  message Level {
    string name = 1;
    int32 hp = 2;
    repeated ParametrizedEntityProto quality = 3;
    repeated ParametrizedEntityProto feat = 4;
    Ability ability_increase = 5;
    repeated string spell_known = 6;
  }
  repeated Level level = 5;
  string campaign_id = 6;
  string player = 7;

  message Abilities {
    int32 strength = 1;
    int32 dexterity = 2;
    int32 constitution = 3;
    int32 intelligence = 4;
    int32 wisdom = 5;
    int32 charisma = 6;
  }
  Abilities abilities = 8;

  message Battle {
    int32 initiative = 1;
  }
  Battle battle = 9;
}

message CompanionMessageProto {
  string sender = 1;
  string debug = 2;

  // General information.
  message Welcome {
    string name = 1;
    string id = 2;
  }
  Welcome welcome = 4;

  // Server push information.
  CampaignProto campaign = 3;

  // Client push information
  CharacterProto character = 5;
}
